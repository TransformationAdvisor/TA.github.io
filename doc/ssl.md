---
layout: page
title: Configuring Ingress to use your own CA certificate
---

For Liberty applications deployed through TA, when Ingress is enabled, Ingress generates a self-signed certificate and key pair that is used to access the application externally via https. 

It is possible to configure Ingress to use your own CA certificate and key pair using these steps:

(1) Encode your key and cert using base64:

```cat my.key | base64```


(2) Create a Secret that contains a CA certificate and key pair in the same namespace as your deployment:

```
apiVersion: v1
kind: Secret
metadata:
  name: ta-tls-ca-key-pair
  namespace: default
type: kubernetes.io/tls
data:
  tls.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUNxRENDQVpBQ0NRRFV3azBsU1BjRGdUQU5CZ2txaGtpRzl3MEJBUXNGQURBV01SUXdFZ1lEVlFRRERBczUKTGpReUxqSTVMakV3TXpBZUZ3MHhPVEF6TVRNeE5UTTFNRFphRncwME5qQTNNamt4TlRNMU1EWmFNQll4RkRBUwpCZ05WQkFNTUN6a3VOREl1TWprdU1UQXpNSUlCSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQVE4QU1JSUJDZ0tDCkFRRUF2L1lvVTJKeU9rNWloV1NsOVMzRllyMzBkbjhObGRJMGRwN2hkSUtlZUJiOWZjT1BJS09Rd0t3UjdCcmwKSXgxSVpqdG1sTmVTSndaNnJ2d1dhdk5GU09iUHhxR2Qwbk5ncUViWkZtT2cvY0h4MUlreTRrT0hib3VyZ0VTMQozdDFYTU0xWUFmNVJtU1E0TkJvZUxBR1lVQWhoMzlpMUp2OWxuR0RXT0ozbGh5L0c4NHgxLzhMYitDUUc3RUI3CmlxNkxrZGg5OHZ6Y0xIYXZWS2FiWnZJeDFyVnR0VUlMS0xCVytwU3l4N2lkVkVhVlczVkZXa202YloxeTR6S0QKQ3hHd21DWHdKREJjYnBSTVhzZkJhYUQ1YUk4eCtoOTYyMlRmRGNQVDJKS2VRMjB2L3BDUjREQ2xvOUZ6L1A0TQpwN2tGcGo5cDYrbVh4c3B3WG1aQmVReXpoUUlEQVFBQk1BMEdDU3FHU0liM0RRRUJDd1VBQTRJQkFRQ0tpYlpXCldZZUVHdnMzTEM4NWU5VHJsbjNoWElvczh2QTNZS1pLNVV1Q3I5VmpNU2RpYThGdU5DcngvcHluS3g2NEtOVmMKazQvZFAwMm1NK0E0cHFvYUYzelhHczdhanovMDM2OG9SQTREZzRYayt3T0lVdkdKNkd1MHc3dkZOczlLRWJoUQo3WkFjRnFYWU4rd1ZaQ0IxeEtoUTRUZmZucCs3RVA3c0l5M1FXZjl3T2IwTVY4bmo5TjNWTktNWHljWFAvazJ4CndjajNXM0dNcitqS2RjbnYxRVFRVjhnREluVks1ODB0WnZ0Z3BFWksrbUpVN2pnUndSb0VzMHFiaFZuZTlHZm0KUGVwSVFwcTJIUGFuWThJcGUrcmtybk42RGFpR1VZdGVSZmQ1VHBWTzRJZ3BxT1VNTFNvbmtTUitPdFRGTFdPNgpuMHRxb1AzL3dad0J4N21pCi0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
  tls.key: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcEFJQkFBS0NBUUVBdi9Zb1UySnlPazVpaFdTbDlTM0ZZcjMwZG44TmxkSTBkcDdoZElLZWVCYjlmY09QCklLT1F3S3dSN0JybEl4MUlaanRtbE5lU0p3WjZydndXYXZORlNPYlB4cUdkMG5OZ3FFYlpGbU9nL2NIeDFJa3kKNGtPSGJvdXJnRVMxM3QxWE1NMVlBZjVSbVNRNE5Cb2VMQUdZVUFoaDM5aTFKdjlsbkdEV09KM2xoeS9HODR4MQovOExiK0NRRzdFQjdpcTZMa2RoOTh2emNMSGF2VkthYlp2SXgxclZ0dFVJTEtMQlcrcFN5eDdpZFZFYVZXM1ZGCldrbTZiWjF5NHpLREN4R3dtQ1h3SkRCY2JwUk1Yc2ZCYWFENWFJOHgraDk2MjJUZkRjUFQySktlUTIwdi9wQ1IKNERDbG85RnovUDRNcDdrRnBqOXA2K21YeHNwd1htWkJlUXl6aFFJREFRQUJBb0lCQUJCL0Z2Z1RmYjJFL3ZKMwpzOHRlSTVoWXVxbDBRYmFlV2VQWHc0Zy9zVjZnbXlnenBoa245VWlaZ1BESlh1ZWxuSk1zaDZSQzRreDRRaExICmx5V1p3bHFCZTFtV2lmbUw4TUtGVkNLWWJUMWhiV2JXWTRrT1JKVTdhNEdhWmdiQS9yMHk2RjFEZmIrclhTa2QKRlhxeXFHUTRWRERvYnFqclNkQW1na0piVDE1T2xwVXpadGZGWFZmZkpRdDRyd21vUzN6VVh1MTE4M1NlT0cyQQpZV1BUNkxhU2ZnV3F5cFdNaDZPdXo1VW9qNHFMbEVVaVorNFRZQk9lRjk3Ry9mUExDSkZTMnhPQisyNzNrbTlXCkFBYjIvb2hKa3BnTEZFVldhb29iWmJaV1oyVko0TnlhTzBtNlkrdy83cVB2bHVkR2JkbUpwMVJuQXJUWnVFcHkKQzdBTWlBRUNnWUVBN3Q0bkY4SDZPYnNzV1cyTjZqZC83cjBQUWlhQWZNdkFMVXl3Tnp4R3l3bVh1ZUt2VVBLQQpGK3dsWWhLWS9mZWVJdlNnUlRaNmtHUTB0Y2d6NkJaYjlFZDJzM2NtZjBpNkFyaUJWRElURUVRZGNuT1Q1ZTJKCmtwRUF4MThneDdMbThlcDNYOXhLUUlzcUFpWi8wMG9ydnFnVXJQUEJ6UGxGMjRCdkprSzZYNjhDZ1lFQXpickMKbzQwNmxVWGF1aHB2NkgzQ0E5NzViU3VKYS8wQUdNVmhXY3NuN0NTYlQ5QzN6bzlSMUNNN2g4ekEzUW40Z0MvNwpyZStvcythVlRyUEdCdFJOTEhzVENYcERYZFQ5SWhBUzBiZjJZMXRaUU9nYkJhTXdaVERiRHBQTms5bnJ4L2M3CkJMNk5EQkUweEpJMXV6dzM5QlhUYlE3R3ZlWm9XUXFXR2FtVm1Rc0NnWUFyUUtpOWdZOW93cjYrRnJ0YXpOL3EKZit0eVkveGlISmJZM1FrUGgyZWVQa2R1RG1FR2ZGSzdnalFtdFExazkyQjRIZW1qZnNEa3duQlU5a0tINVB5VAptQmtqV0JEdGZXTEpPVldaeEZOMVg1QWhlRkl3a1RtWEE1Q3JpVXNyUGZiWm1VWXlZblpEaDY5OG9qSUZOV29FClpQVVJlRFlBZ3FhbW4zUUE3cFpHMndLQmdRQ01NbXB6dEVtbzhncWxhbUM2eWdDT1RNUWpibGplMjNIV2I2UHcKNGk0WmtiUzVocDNMeVFWVmtKRC84VHU1SmhOUG4rTmVYQVRXWEJ1Qm42Y2lma2o5Ti8zNEpuYUVHaUpLdFROdAo4WFNacnVXN0FyRnZmUTc4MW5kaGpyMjR0UGdsdEVobTZrZ0tZaXRZamQ3SjhyYWF3c2pxOS9mZDc0ZEtycGt0CmNkQzlrd0tCZ1FDZHRoczI4MFNickxVR1RYZ21zSGRxS1JjYXVLN0VSRnl4MTFzbXRMVS9nbVU4bmZBY080bTAKV0llYW1OQ1FsejV0Ymx6cjRGdkthQmt6Q0Jsb3ZTTDZKRjd5TWhiWWhxQ1Z2bGV5ZDVnaEkzeFBFVmdiQ013dQprdWMrdGE4UjhsMVArb0dwVzlYM2hOdEhyUktucHlKckRlcUJkb29ialZ6eUp2d1hreTE0L3c9PQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo=
```

(3) Alternatively, use the CLI to create the secret. You can reference the certificate and keypair files without encoding them in base64.

```
kubectl create secret tls ta-tls-ca-key-pair --key ./ta.key --cert ./ta.crt
```

(4) In the migration bundle generated by TA, update the _host_ and _secretName_ attributes for the Ingress feature in the values.yaml file:

```
ingress:
  enabled: true
  rewriteTarget: "/"
  path: "/modresortswar/"
  host: "tademo.rtp.raleigh.ibm.com"
  secretName: "ta-tls-ca-key-pair "
```

The _secretName_ is the name of the secret created in Step 2/3. _host_ is the fully-qualified domain name that resolves to the IP address of your clusterâ€™s proxy node. The value for _host_ must also match the _commonName_ specified in the certificate and key pair.

(5) Deploy the application using the updated migration bundle files


It is also possible to use the IBM Cloud Private cert-manager to issue and manage certificates. Detailed steps is described in this document:
https://www.ibm.com/support/knowledgecenter/en/SSBS6K_3.1.0/manage_applications/create_cert.html#adding_ingress

After a certificate is generated, as described in Step 2, this certificate can now be used by Liberty deployments in TA. Update values.yaml as described in our Step 4 to use this certificate. 

